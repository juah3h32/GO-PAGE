---
// src/pages/[lang]/productos.astro

import "../../styles/producto.css";
import "../../styles/carousel.css";
import "../../styles/flechas.css";

import BaseLayout from "../../layouts/BaseLayout.astro";
import CustomCursor from "../../components/CustomCursor.astro";
import Navbar from "../../components/Nadbar.astro"; 
import { languages, translations } from "../../i18n";

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

const { lang } = Astro.params;
const currentLang = (lang && lang in translations) ? lang : 'es';
const t = translations[currentLang as keyof typeof translations];

const productsList = t.products_list; 
const seeMoreText = t.common.seeMore;
---

<BaseLayout title={`${t.nav.products} | Grupo Ortiz`}>
  
  <Navbar currentLang={currentLang} />
  <CustomCursor />

  <main class="productos-main">
    <div class="carousel">
      <div class="list">
        
        {productsList.map((item) => (
          <div class="item">
            <img src={`/images/${item.img}`} alt={item.division} />

            {/* CORRECCIÓN DEFINITIVA:
                1. Quitamos 'dir' y 'style' de este contenedor padre (.introduce).
                   Al dejarlo por defecto (LTR), Flexbox alineará todo a la IZQUIERDA siempre.
                   Esto soluciona que el botón se vaya a la derecha.
            */}
            <div class="introduce">
              
              {/* 2. Aplicamos la lógica árabe INDIVIDUALMENTE a cada texto.
                    - dir='rtl': Para que la puntuación (puntos, comas) se ponga en el lugar correcto.
                    - textAlign: 'left': Para forzar visualmente que el texto se pegue a la izquierda.
              */}
              <div 
                class="title" 
                dir={currentLang === 'ar' ? 'rtl' : 'ltr'} 
                style={currentLang === 'ar' ? { textAlign: 'left' } : {}}
              >
                GRUPO ORTIZ
              </div>
              
              <div 
                class="topic" 
                dir={currentLang === 'ar' ? 'rtl' : 'ltr'}
                style={currentLang === 'ar' ? { textAlign: 'left' } : {}}
              >
                {item.division}
              </div>
              
              <div 
                class="des" 
                dir={currentLang === 'ar' ? 'rtl' : 'ltr'}
                style={currentLang === 'ar' ? { textAlign: 'left' } : {}}
              >
                {item.descripcion}
              </div>
              
              {/* 3. El botón se queda sin cambios. 
                     Al estar en un contenedor LTR, se quedará alineado a la izquierda automáticamente.
              */}
              <a href={`/${currentLang}/${item.slug}`} class="seeMore">
                {seeMoreText}
              </a>

            </div>
          </div>
        ))}

      </div>

      <div class="arrows">
        <button id="prev" aria-label="Anterior">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
        </button>
        <button id="next" aria-label="Siguiente">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </button>
      </div>
    </div>
  </main>

  <script src="/scripts/producto.js" defer></script>
</BaseLayout>