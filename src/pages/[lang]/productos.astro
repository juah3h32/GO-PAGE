---
// src/pages/[lang]/productos.astro

// 1. IMPORTACIONES
import "../../styles/producto.css";
import "../../styles/carousel.css";
import "../../styles/flechas.css";

import BaseLayout from "../../layouts/BaseLayout.astro";
import CustomCursor from "../../components/CustomCursor.astro";
// CORRECCIÓN: Nombre del archivo correcto (Navbar, no Nadbar)
import Navbar from "../../components/Nadbar.astro"; 
// CORRECCIÓN: Ruta de importación actualizada a la carpeta i18n
import { languages, translations } from "../../i18n";

// 2. GENERACIÓN DE RUTAS DINÁMICA
// Crea una página por cada idioma definido en src/i18n/index.ts
export function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

// 3. LÓGICA DE IDIOMA
const { lang } = Astro.params;

// Seguridad: Validamos que el idioma exista, si no, usamos 'es'
const currentLang = (lang && lang in translations) ? lang : 'es';
const t = translations[currentLang as keyof typeof translations];

// Extraemos los datos necesarios
// NOTA: Ya no necesitamos 'navData' aquí porque el Navbar lo obtiene solo.
const productsList = t.products_list; 
const seeMoreText = t.common.seeMore;
---

<BaseLayout title={`${t.nav.products} | Grupo Ortiz`}>
  
  <Navbar currentLang={currentLang} />
  
  <CustomCursor />

  <main class="productos-main" dir={currentLang === 'ar' ? 'rtl' : 'ltr'}>
    <div class="carousel">
      <div class="list">
        
        {productsList.map((item) => (
          <div class="item">
            <img src={`/images/${item.img}`} alt={item.division} />

            <div class="introduce">
              <div class="title">GRUPO ORTIZ</div>
              <div class="topic">{item.division}</div>
              <div class="des">{item.descripcion}</div>
              
              <a href={`/${currentLang}/${item.slug}`} class="seeMore">
                {seeMoreText}
              </a>
            </div>
          </div>
        ))}

      </div>

      <div class="arrows">
        <button id="prev" aria-label="Anterior">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
        </button>
        <button id="next" aria-label="Siguiente">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </button>
      </div>
    </div>
  </main>

  <script src="/scripts/producto.js" defer></script>
</BaseLayout>