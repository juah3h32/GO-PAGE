---
/* src/components/DockMenu.astro */
const currentPath = Astro.url.pathname;

/* 1. DETECTAR IDIOMA
   Toma el primer segmento de la URL (ej: "es", "en").
   Si no hay segmento (estás en la raíz pura), asume 'es'. */
const lang = currentPath.split('/')[1] || 'es';

/* 2. LÓGICA DE ACTIVACIÓN (SOLO UNO A LA VEZ) */
// ¿Estamos en productos?
const isProducts = currentPath.includes('productos');

// ¿Estamos en Home? (Solo si NO es productos y es la ruta raíz o raíz del idioma)
const isHome = !isProducts && (currentPath === '/' || currentPath === `/${lang}` || currentPath === `/${lang}/`);

/* 3. LISTA NEGRA (Ocultar menú en estas páginas) */
const rutasOcultas = ['cuerdas', 'otra-pagina-si-quieres'];
const debeOcultarse = rutasOcultas.some(ruta => currentPath.includes(ruta));
---

{ !debeOcultarse && (

<div class="mobile-app-dock">
  
  <a href={`/${lang}`} class={`dock-item ${isHome ? 'active' : ''}`} aria-label="Inicio">
    <div class="icon-container">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
    </div>
  </a>

  <a href={`/${lang}/productos`} class={`dock-item ${isProducts ? 'active' : ''}`} aria-label="Productos">
    <div class="icon-container">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
    </div>
  </a>

  <a href="https://wa.me/521234567890" target="_blank" class="dock-item" aria-label="WhatsApp">
    <div class="icon-container">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
    </div>
  </a>

  <a href="javascript:history.back()" class="dock-item" aria-label="Regresar">
    <div class="icon-container">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 14 4 9 9 4"></polyline><path d="M20 20v-7a4 4 0 0 0-4-4H4"></path></svg>
    </div>
  </a>

</div>

)}

<style>
  /* --- ESTILOS DE ESCRITORIO (OCULTO) --- */
  .mobile-app-dock {
    display: none;
  }

  /* --- ESTILOS MÓVILES --- */
  @media screen and (max-width: 1024px) {
    .mobile-app-dock {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        align-items: flex-end; /* Alinea items abajo */
        justify-items: center;
        
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 70px;
        
        background: #ffffff;
        
        /* Borde redondeado arriba (opcional) */
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
        
        /* Sombra suave para la barra */
        box-shadow: 0 -5px 20px rgba(0,0,0,0.05); 
        
        z-index: 2000;
        padding-bottom: 10px; /* Safe area */
        
        /* CRUCIAL: Permite que el botón flote fuera de la caja */
        overflow: visible; 
    }

    .dock-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        color: #999999; 
        text-decoration: none;
        position: relative;
        transition: all 0.3s ease;
        -webkit-tap-highlight-color: transparent;
    }

    .icon-container {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: transparent;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .dock-item svg {
        width: 24px;
        height: 24px;
        stroke-width: 2px;
        transition: stroke 0.3s;
    }

    /* --- ESTADO ACTIVO (Círculo Flotante) --- */
    .dock-item.active .icon-container {
        /* Color Naranja (cámbialo aquí si quieres otro) */
        background-color: #F05537; 
        color: white; 
        
        /* Efecto de elevación */
        transform: translateY(-25px); 
        
        /* Tamaño más grande al activarse */
        width: 55px;
        height: 55px;
        
        /* Sombra del botón flotante */
        box-shadow: 0 8px 15px rgba(240, 85, 55, 0.4);
        
        /* El borde blanco que crea el efecto de "recorte" */
        border: 6px solid #ffffff;
    }

    .dock-item.active svg {
        stroke: white;
        width: 26px;
        height: 26px;
    }
  }
</style>